# 闭包

在 Python 中，闭包是经常被提及的一个概念。那么，什么是闭包呢？

首先，我们需要知道在 Python 中，函数也是对象。因此，像其他对象一样，函数也可以作为另一个函数的参数或返回值。

如果在一个函数内部定义了另一个函数，并且内部函数引用了外部函数的变量或参数，则内部函数称为“闭包”。

闭包可以实现许多有用的特性，例如实现装饰器、实现延迟计算等。通过使用闭包，我们可以将函数作为另一个函数的参数传递，将函数作为另一个函数的返回值返回，还可以在函数内部定义新的函数等。

下面，我们通过一个例子来了解闭包的具体用法：

```python
def adder(x):
    def inner(y):
        return x + y
    return inner

add5 = adder(5)
add10 = adder(10)

print(add5(3))  # 输出 8
print(add10(3))  # 输出 13
```

在这个例子中，我们定义了一个 adder 函数，它的作用是返回一个名为 inner 的函数，inner 函数会返回两个数的和。在 adder 函数内部，我们定义了一个 inner 函数，它的参数为 y。在 inner 函数内部，我们将 x 和 y 相加，得到两数字的和。

接下来，我们通过调用 adder 函数来创建两个新的函数 add5 和 add10。add5 函数的 x 参数值为 5，而 add10 函数的 x 参数值为 10。因此，当我们调用 add5(3) 时，输出的结果应该为 8，而当我们调用 add10(3) 时，输出结果应该为 13。

这里需要着重理解的是，当我们调用 adder(5) 时，实际上返回的是 inner 函数。在 inner 函数被返回之后，它仍然可以访问 adder 函数中的变量 x，这是因为 inner 函数已经“捕获”了变量 x。因此，我们在调用 add5(3) 时，inner 函数会将 5 和 3 相加，并返回 8。

在 Python 中，闭包可以帮助我们使用更少的代码实现更多的功能。不过，使用闭包时需要注意，当内部函数访问外部函数的变量时，如果外部函数返回了，那么内部函数依然可以访问这些变量。因此，如果有多个闭包引用了同一个外部函数的变量，那么这些变量将会存在于内存中，直到没有任何闭包引用它们为止，这可能会导致内存占用过高的问题。