# DNS域名解析

在网络通信世界中，一切的连接都是基于 IP 地址的。但是如果我们每次访问一个网站，都要输入它的 IP 地址，那么就显得非常麻烦，并且不直观。因此诞生了域名，比如`www.baidu.com`，这样用户就可以更方便的记住网站地址，而不用每次都去记住一串无比枯燥的 IP 地址。

而域名首先要转化成 IP 地址才可以与服务器进行连接。而这么一件看似简单的事情，背后所涉及的技术和流程却十分复杂。解析域名的过程成为了 DNS 域名解析。

## DNS 的作用

DNS 的全称是 Domain Name System，即域名系统。它是一个分布式的命名系统，用于管理和解析网络上的域名。所有的域名解析服务都是借助 DNS 来完成的。

在进行 DNS 解析之前，我们需要先了解几个 DNS 的基本概念：

1. DNS 服务器：存储着各种域名到 IP 地址之间的映射关系，可以将一个域名解析成其相应的 IP 地址。
2. 根域名服务器：存储着所有全球国际顶级域名（如.com、.org 等）的 IP 地址映射关系。
3. 本地 DNS 服务器：负责将用户电脑的 DNS 解析请求直接解析到用户所在互联网服务提供商(ISP)的 DNS 服务器上去获取响应。
4. 域名服务器：存储某个具体域名下所有子域名和主机名的 IP 地址映射关系。

## DNS 的解析流程

DNS 解析可以分为以下几个步骤：

### 1. 浏览器缓存查询

在浏览器发送 DNS 请求之前，它会先从自己的缓存中查询，如果缓存中有这个域名对应的解析记录，那么就直接使用缓存中的 IP 地址进行连接，无需再发送 DNS 解析请求。这也是为什么有时候我们修改了网站的 IP 地址，但迟迟不能立即生效的原因之一。

### 2. 建立本地 DNS 服务器连接

如果不能从本地缓存中获取解析结果，浏览器就会将请求发送到本地 DNS 服务器。本地 DNS 服务器记录着自己所在 local IP，负责将用户电脑的 DNS 解析请求直接解析到用户所在互联网服务提供商(ISP)的 DNS 服务器上去获取响应。

### 3. 根域名服务器查询

如果本地 DNS 服务器没有相应的解析记录，它会继续向上级 DNS 服务器请求解析，一直到根域名服务器。

根域名服务器的 IP 地址是预先设置在本地 DNS 服务器中的，所以本地 DNS 服务器会将请求直接发到根域名服务器的 IP 地址。

### 4. 顶级域名服务器查询

根域名服务器返回自己知道负责管理该域名的顶级域名服务器的 IP 地址信息，然后本地 DNS 向该顶级域名服务器发送 DNS 请求。

### 5. 权威域名服务器查询

顶级域名服务器返回存储着该域名下的权威域名服务器的 IP 地址信息，本地 DNS 再向其发送 DNS 请求，对该域名下的 DNS 记录进行查询，最终拿到域名对应的 IP 地址信息。

## 总结

DNS 域名解析是将域名转换为 IP 地址的过程，通过 DNS 服务器进行解析。DNS 解析会依次向浏览器缓存、本地 DNS 服务器、根域名服务器、顶级域名服务器和权威域名服务器发起请求，最终返回域名对应的 IP 地址。理解 DNS 解析，对了解网络访问流程有很大的帮助。