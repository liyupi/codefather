# NFA

在正则表达式的解析中我们已经遇见过 * , + , ? 等一些特殊符号，它们是用来描述各种文本匹配规则的。那么很自然的有这样一个问题：这些规则是从哪里来的呢？它们是如何转化为我们能够使用的算法的呢？这便需要介绍一种机器模型：非确定性有限自动机(NFA)。

NFA可以轻松地理解为，它在读入任一符号的时候，都会有多个下一步的选择。这些选择可能导致机器进入不同的状态，从而影响整个机器的行为。

NFA的状态转移表可以描述成一张表格，其中每个表格中的单元格会包含一个状态集合。在读入一个符号后，状态集合会发生变化，从而改变机器所处的状态。我们之所以称之为“非确定性”，是因为在同一个状态下，它可以有多种不同的状态变化路线可供选择。在设计NFA时，我们可以利用这些不同的状态路线，构造出更加复杂的匹配规则。

下面我们通过一个简单的例子来具体了解一下NFA。

我们输入一个字符串“dog”，经过一个简单的NFA，可以匹配到由这个字母组成的单词“dog”。图示如下：

```
┌─ d ─┐
│    v
    ┌──o──┐
    │     v
        ┌──g──┐
        │      v
        └──────┘
```

NFA有两个出边都指向“o”节点。这样我们就可以在每个状态节点保留一些备选方案，而不仅仅是一个唯一的状态转移规则。通过这种设计，我们可以编写更加简洁、灵活的正则表达式，而不必拘泥于一个固定的逻辑路线。同时，NFA可以被用于大量的匹配问题上，很好地解决了很多非正则化、棘手的问题。